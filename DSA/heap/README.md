# 数据结构之堆

## 目录

- [数据结构之堆](#数据结构之堆)
  - [目录](#目录)
  - [定义](#定义)
    - [其他性质](#其他性质)
  - [最小堆的建立过程](#最小堆的建立过程)
    - [ShiftUp与ShiftDown操作](#shiftup与shiftdown操作)
    - [建堆](#建堆)
    - [插入](#插入)
    - [删除](#删除)
  - [时间复杂度分析](#时间复杂度分析)
  - [应用](#应用)

## 定义

堆分为**最小堆和最大堆**， 首先来看最小堆的定义：

最小堆是一个关键码序列， 假如关键码序列的集合是
$$
K=\{k_0,k_1,k_2,...,k_{n-1}\}
$$
把它的所有元素按**完全二叉树**的顺序存储在一个一维数组中。并且满足:
$$
k_i \leq k_{2i+1}\;且\; k_i \leq k_{2i+2},\quad i=0,1,2,...,\lfloor (n/2) \rfloor-1
$$
可以看出在最小堆中， **任意结点都小于或等于它的左右子结点的关键码， 位于堆顶的关键码最小。**

而最大堆唯一不同的是堆关键序列的条件:
$$
k_i \geq k_{2i+1}\;且\; k_i \geq k_{2i+2},\quad i=0,1,2,...,\lfloor (n/2) \rfloor - 1
$$
与最小堆相反， **任意结点都大于或等于它的左右子结点的关键码， 位于堆顶的关键码最最大。**



<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="551px" viewBox="-0.5 -0.5 551 251" content="&lt;mxfile host=&quot;Electron&quot; modified=&quot;2021-05-26T15:01:29.769Z&quot; agent=&quot;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/13.6.2 Chrome/83.0.4103.122 Electron/9.2.0 Safari/537.36&quot; etag=&quot;gT15y9mXLOryXQ1fFssM&quot; version=&quot;13.6.2&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;DJ5Mo7QN-1ra0_fof8oz&quot; name=&quot;Page-1&quot;&gt;7ZtNd6MgFIZ/jcuZI37FLM1Hp4vObLpoZ8lEqvQY8RjSJP31gxGiFhNtTys4k00OXBX15T5w4RrDnq/3P3KYxT9JiBLDMsO9YS8My5p4PvstDIfS4PhWaYhyHJYmUBnu8SviRpNbtzhEm8aJlJCE4qxpXJE0RSvasME8J7vmaU8kad41gxGSDPcrmMjWBxzSuLT6rlnZbxGOYnFnYPIjayhO5oZNDEOyq5nspWHPc0JoWVrv5ygptBO6lNfdnDl6erAcpbTPBendw8YKggA92/ECvqL81/PtN5t3zwtMtvyN+dPSg5Agysk246ehnKJ9m/DwjzjdlB8MnF6XuQkia0TzAzuFN2R7/BLuImDK67tKcEsIHtfEtoTWkHdydGq70oEVuBTvkMWyJVn8iSQMa4i5IavMdjGm6D6Dq+LIjoHAbDFds3suACvCTVb65hPeI3bf2Vk166pd6LCzWgJL1s5pkc75MuU8STnXHoVyftMLXdVCyiCikA1NvJqStJCPoZmGhTALk9VITmMSkRQmd4RkXMJnROmBD6xwS0lTYLTH9LFW/l0rL/a83WPlICope73HeuV3vVJddKxVV4VBMRxXj84sN7jQ5Hi8fNniDT/Sq0wmss1XqAfSFOYRutRi6cGyn+QogRS/NJ/v87t9IvFjgzHwc5qxxShuqgbI1RYg1Sh4fVGYKEVBjk3M6RhQAK5uKDiDomC+AwUxl3x3xzWb9EbojKsMg5CYOmoITXzZF/RDyNMsGJOnYJW0gHGx0jfyss+sEwdixZJY8VpCCP1YmWo229imrNo18KoPx90kWEpJcCUSnFGQYGtGgtUSrl7jrmEIcpUSJO+CWaPYBXu7FeupnkuGXbl8ZBdsbAS5fQlSug9my/tgQO8deG2QkXMXwzA0Hs9Wuq0lOl5lyk2/jJsjiaLJXp9jXlRSecJNjtU1WbV2Cadbvk3fVatO+Tahf+do7PQcjJXG6XKYrkmavwMe7ZJtYNiVrvo9n94c9A1KlEbbcrCtSZqgaxLRLdMGWmS77vgMwY/SmF7OVGuyWO3gR7M0G5D3yP77NNunB1xKE9JTCRRNMgsdoOiWY2sbXq7xVm0o7sRgqhIDEb7rlx/o4EC3DBu4ftmkiB9wxlEGAkj+sEmTz2TfF3EpzxYAT9uJZKQAibG9myClnzsBSyJIkz9qnCNIG2TkLfdhGBqPZ1sqPduR5wZj6RnTueGbxtI1Zqbh3xSFgBXk4Y/5K33j2wmOUlZeMR1RzgyFV+MVTAJ+YI3DMDn2MdrgV56XK7okIzilx/dzZ4a7KNpi3bopexj0peRyLg+IFZT4h2VLRqo9l/dV+ssjS0P/wDGCyb+jv/MmkfWF+rNq9X/R47Han27t5V8=&lt;/diagram&gt;&lt;/mxfile&gt;" onclick="(function(svg){var src=window.event.target||window.event.srcElement;while (src!=null&amp;&amp;src.nodeName.toLowerCase()!='a'){src=src.parentNode;}if(src==null){if(svg.wnd!=null&amp;&amp;!svg.wnd.closed){svg.wnd.focus();}else{var r=function(evt){if(evt.data=='ready'&amp;&amp;evt.source==svg.wnd){svg.wnd.postMessage(decodeURIComponent(svg.getAttribute('content')),'*');window.removeEventListener('message',r);}};window.addEventListener('message',r);svg.wnd=window.open('https://viewer.diagrams.net/?client=1&amp;edit=_blank');}}})(this);" style="cursor:pointer;max-width:100%;max-height:251px;"><defs/><g><ellipse cx="440" cy="20" rx="20" ry="20" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 20px; margin-left: 421px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">87</div></div></div></foreignObject><text x="440" y="24" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">87</text></switch></g><ellipse cx="500" cy="70" rx="20" ry="20" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 70px; margin-left: 481px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">53</div></div></div></foreignObject><text x="500" y="74" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">53</text></switch></g><path d="M 454.14 34.14 L 485.86 55.86" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><ellipse cx="530" cy="120" rx="20" ry="20" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 120px; margin-left: 511px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">31</div></div></div></foreignObject><text x="530" y="124" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">31</text></switch></g><path d="M 514.14 84.14 L 522.12 101.62" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><ellipse cx="470" cy="120" rx="20" ry="20" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 120px; margin-left: 451px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">09</div></div></div></foreignObject><text x="470" y="124" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">09</text></switch></g><path d="M 485.86 84.14 L 470 100" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><ellipse cx="380" cy="70" rx="20" ry="20" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 70px; margin-left: 361px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">78</div></div></div></foreignObject><text x="380" y="74" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">78</text></switch></g><path d="M 425.86 34.14 L 394.14 55.86" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><ellipse cx="410" cy="120" rx="20" ry="20" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 120px; margin-left: 391px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">65</div></div></div></foreignObject><text x="410" y="124" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">65</text></switch></g><path d="M 394.14 84.14 L 402.12 101.62" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><ellipse cx="350" cy="120" rx="20" ry="20" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 120px; margin-left: 331px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">45</div></div></div></foreignObject><text x="350" y="124" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">45</text></switch></g><path d="M 365.86 84.14 L 350 100" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><ellipse cx="380" cy="180" rx="20" ry="20" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 180px; margin-left: 361px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">23</div></div></div></foreignObject><text x="380" y="184" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">23</text></switch></g><path d="M 364.14 134.14 L 380 160" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><ellipse cx="320" cy="180" rx="20" ry="20" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 180px; margin-left: 301px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">17</div></div></div></foreignObject><text x="320" y="184" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">17</text></switch></g><path d="M 341.06 137.89 L 328.94 162.11" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><ellipse cx="140" cy="20" rx="20" ry="20" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 20px; margin-left: 121px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">09</div></div></div></foreignObject><text x="140" y="24" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">09</text></switch></g><ellipse cx="200" cy="70" rx="20" ry="20" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 70px; margin-left: 181px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">65</div></div></div></foreignObject><text x="200" y="74" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">65</text></switch></g><path d="M 154.14 34.14 L 185.86 55.86" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><ellipse cx="230" cy="120" rx="20" ry="20" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 120px; margin-left: 211px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">87</div></div></div></foreignObject><text x="230" y="124" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">87</text></switch></g><path d="M 214.14 84.14 L 222.12 101.62" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><ellipse cx="170" cy="120" rx="20" ry="20" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 120px; margin-left: 151px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">78</div></div></div></foreignObject><text x="170" y="124" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">78</text></switch></g><path d="M 185.86 84.14 L 170 100" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><ellipse cx="80" cy="70" rx="20" ry="20" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 70px; margin-left: 61px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">17</div></div></div></foreignObject><text x="80" y="74" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">17</text></switch></g><path d="M 125.86 34.14 L 94.14 55.86" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><ellipse cx="110" cy="120" rx="20" ry="20" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 120px; margin-left: 91px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">45</div></div></div></foreignObject><text x="110" y="124" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">45</text></switch></g><path d="M 94.14 84.14 L 102.12 101.62" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><ellipse cx="50" cy="120" rx="20" ry="20" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 120px; margin-left: 31px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">23</div></div></div></foreignObject><text x="50" y="124" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">23</text></switch></g><path d="M 65.86 84.14 L 50 100" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><ellipse cx="80" cy="180" rx="20" ry="20" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 180px; margin-left: 61px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">31</div></div></div></foreignObject><text x="80" y="184" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">31</text></switch></g><path d="M 64.14 134.14 L 80 160" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><ellipse cx="20" cy="180" rx="20" ry="20" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 180px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">53</div></div></div></foreignObject><text x="20" y="184" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">53</text></switch></g><path d="M 41.06 137.89 L 28.94 162.11" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><rect x="85" y="230" width="50" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 240px; margin-left: 110px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">最小堆</div></div></div></foreignObject><text x="110" y="244" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">最小堆</text></switch></g><rect x="420" y="230" width="50" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 240px; margin-left: 445px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">最大堆</div></div></div></foreignObject><text x="445" y="244" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">最大堆</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://desk.draw.io/support/solutions/articles/16000042487" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>

以上展示了最小堆和最大堆的图示， 显然， **堆仅仅是堆父子结点作了约束， 并未对兄弟结点间进行约束。**

### 其他性质

由于堆存储在下标从0长度为n的数组中，根据完全二叉树的性质可以推断出如下结论:

- 对于下标i, 如果i = 0， 则结点i为根结点无父结点; 否则i > 0，则结点i的父结点为 (i -1)/2
- 如果(2i +1) > (n - 1), 则结点无左子结点; 否则有左子结点时， 其结点为 2i+1
- 如果(2i +2) > (n - 1), 则结点无右子结点; 否则有右子结点时， 其右点为 2i+2
- 如果i为奇数，且 i != n，则结点i为左子树，其右兄弟结点为i + 1
- 如果i为偶数，且 i != 0，则结点i为右子树，其左兄弟结点为i - 1

## 最小堆的建立过程

### ShiftUp与ShiftDown操作

**shiftup**是用于将指定的数据向树上层移动的过程， 根据最小堆的性质， 如果当前值小于父结点的值， 则交换父结点的值。继续向上直到大于父结点或无父结点为止。

而对于**shiftdown**用于将指定的数据向树下层移动的过程，根据最小堆的性质，找到两子结点的最小值， 如果指定值比子结点最小值大，则与最小值进行交换，直到小于所有子结点或无子结点为止。

### 建堆

由于差不多一半的结点为叶子结点， 而叶子结点本身已经形成最小堆。假如堆数据长度为N， 则建堆是在 [N/2-1,0]之间的`shiftdown` 的过程。如以下伪代码:

```c
for (i = N/2 -1 ;i >=0; --i){
    shift_down(i);
}
```

### 插入

对于插入的过程，基本思路是， 将新数据放到数组最后， 然后将数据`shiftup` 的过程，如以下伪代码:

```c
heapArray[N -1] = newVal;
shiftup(N-1);
++N;
```

### 删除

删除的基本思路是将数组最后一个元素覆盖即将被删除的元素， 然后根据被删除元素与父子结点间的关系决定是`shiftup`或`shiftdown`， 伪代码如下:

```c
heapArray[delpos] = heapArray[N-1];
if (heapArray[delpos] < heapArray[delpos_father]){
    shiftup(delpos);
}else shiftdown(delpos);
```



## 时间复杂度分析

- 建堆: O(N)
- 插入和删除: O(logN)



## 应用

- 可用于构建优先队列

  

